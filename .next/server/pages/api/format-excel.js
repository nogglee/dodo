"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/format-excel";
exports.ids = ["pages/api/format-excel"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "xlsx":
/*!***********************!*\
  !*** external "xlsx" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("xlsx");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fformat-excel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fformat-excel.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fformat-excel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fformat-excel.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/format-excel.ts */ \"(api)/./pages/api/format-excel.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/format-excel\",\n        pathname: \"/api/format-excel\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmZvcm1hdC1leGNlbCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGZm9ybWF0LWV4Y2VsLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQ3dEO0FBQ3hEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvZm9ybWF0LWV4Y2VsLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9mb3JtYXQtZXhjZWxcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9mb3JtYXQtZXhjZWxcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fformat-excel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fformat-excel.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/format-excel.ts":
/*!***********************************!*\
  !*** ./pages/api/format-excel.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! xlsx */ \"xlsx\");\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_4__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_0__]);\nformidable__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\nconst PYTHON_PATH = process.env.PYTHON_PATH || \"python3\";\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\n// ÏÖÄ ÌÅ¨Í∏∞ ÏûêÎèô Ï°∞Ï†à Ìï®Ïàò\nconst autoFitColumns = (worksheet, data)=>{\n    const columnWidths = data[0].map((_, colIndex)=>{\n        return Math.max(...data.map((row)=>row[colIndex] ? row[colIndex].toString().length : 10));\n    });\n    worksheet[\"!cols\"] = columnWidths.map((width)=>({\n            wch: width + 2\n        }));\n};\n// ÏÖÄ Ïä§ÌÉÄÏùº ÏÑ§Ï†ï Ìï®Ïàò\nconst setCellStyles = (worksheet)=>{\n    const columnsToFormat = [\n        'C',\n        'D',\n        'F',\n        'H',\n        'J',\n        'L',\n        'N',\n        'P',\n        'R',\n        'T',\n        'U',\n        'V',\n        'W',\n        'X',\n        'Y',\n        'Z',\n        ,\n        'AB',\n        'AC',\n        'AD',\n        'AE',\n        'AF',\n        'AG'\n    ];\n    const maxRow = worksheet['!ref'] ? parseInt(worksheet['!ref'].split(':')[1].match(/\\d+/)?.[0] || \"2\") : 2;\n    columnsToFormat.forEach((col)=>{\n        for(let row = 2; row <= maxRow; row++){\n            const cellAddress = `${col}${row}`;\n            if (worksheet[cellAddress]) {\n                worksheet[cellAddress].z = '#,##0'; // Ïà´Ïûê ÌòïÏãù: 3ÏûêÎ¶¨ÎßàÎã§ ÏΩ§Îßà\n            }\n        }\n    });\n};\nconst parseForm = async (req)=>{\n    return new Promise((resolve, reject)=>{\n        const form = (0,formidable__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            multiples: false,\n            uploadDir: \"/tmp\",\n            keepExtensions: true\n        });\n        form.parse(req, (err, fields, files)=>{\n            if (err) reject(err);\n            else resolve({\n                files\n            });\n        });\n    });\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method Not Allowed\"\n        });\n    }\n    try {\n        const { files } = await parseForm(req);\n        if (!files.file) {\n            return res.status(400).json({\n                error: \"File not found or invalid file\"\n            });\n        }\n        const file = Array.isArray(files.file) ? files.file[0] : files.file;\n        if (!file.filepath) {\n            return res.status(400).json({\n                error: \"Invalid file path\"\n            });\n        }\n        console.log(\"üìå Processing encrypted file:\", file.filepath);\n        const decryptedFilePath = file.filepath.replace(\".xlsx\", \"_decrypted.xlsx\");\n        const command = `${PYTHON_PATH} decrypt_excel.py \"${file.filepath}\" \"${decryptedFilePath}\"`;\n        try {\n            const { stdout, stderr } = await (0,util__WEBPACK_IMPORTED_MODULE_3__.promisify)(child_process__WEBPACK_IMPORTED_MODULE_4__.exec)(command);\n            console.log(\"üìå Python Output:\", stdout);\n            console.error(\"üìå Python Error:\", stderr);\n            if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(decryptedFilePath)) {\n                throw new Error(`‚ùå Decrypted file not found: ${decryptedFilePath}`);\n            }\n            console.log(\"‚úÖ Decrypted file created:\", decryptedFilePath);\n        } catch (error) {\n            console.error(\"‚ùå Failed to decrypt file:\", error);\n            return res.status(500).json({\n                error: \"Failed to decrypt file. Check password or encryption type.\"\n            });\n        }\n        // ÏïîÌò∏ Ìï¥Ï†úÎêú ÌååÏùºÏùÑ ÏùΩÍ∏∞\n        const workbook = xlsx__WEBPACK_IMPORTED_MODULE_2__.readFile(decryptedFilePath);\n        const sheet = workbook.Sheets[workbook.SheetNames[0]];\n        const jsonData = xlsx__WEBPACK_IMPORTED_MODULE_2__.utils.sheet_to_json(sheet, {\n            header: 1\n        });\n        console.log(\"‚úÖ Excel data loaded:\", jsonData.length);\n        // ÏÉàÎ°úÏö¥ ÏãúÌä∏ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±\n        const newSheetData = [];\n        // Í≥†Ï†ïÎêú Ïª§Ïä§ÌÖÄ Ìó§Îçî ÏÑ§Ï†ï\n        newSheetData[0] = [\n            \"ÏÑ±Ìï®\",\n            \"Ï¥ù Ïò§ÎçîÏàò\",\n            \"Í∏∞Î≥∏ Í∏àÏï°\",\n            \"ÏßÄÏó≠Îã®Í∞Ä\",\n            \"Î∞∞Îã¨Í±∞Î¶¨ Ìï†Ï¶ù\",\n            \"\",\n            \"ÌîΩÏóÖÏßÄ Ìï†Ï¶ù\",\n            \"\",\n            \"ÎèÑÏ∞©ÏßÄ Ìï†Ï¶ù\",\n            \"\",\n            \"Í∏∞ÏÉÅ Ìï†Ï¶ù\",\n            \"\",\n            \"Í∏∞ÌÉÄ ÌîÑÎ°úÎ™®ÏÖò 1\",\n            \"\",\n            \"Í∏∞ÌÉÄ ÌîÑÎ°úÎ™®ÏÖò 2\",\n            \"\",\n            \"Í∏∞ÌÉÄ ÌîÑÎ°úÎ™®ÏÖò 3\",\n            \"\",\n            \"Í∏∞ÌÉÄ ÌîÑÎ°úÎ™®ÏÖò 4\",\n            \"\",\n            \"Ï†ïÏÇ∞Í∏àÏï°\",\n            \"Ï¥ù ÏßÄÏõêÍ∏à\",\n            \"Ï∞®Í∞êÎÇ¥Ïó≠\",\n            \"Ìï©Í≥ÑÍ∏àÏï°\",\n            \"ÏßÄÏÇ¨ ÌîÑÎ°úÎ™®ÏÖò\",\n            \"ÏïºÍ∞Ñ ÌîÑÎ°úÎ™®ÏÖò\",\n            \"Í≥ºÏÑ∏ Ìï≠Î™©\",\n            \"ÎπÑÍ≥ºÏÑ∏ Ìï≠Î™©\",\n            \"\",\n            \"\",\n            \"\",\n            \"ÏõêÏ≤úÏÑ∏\",\n            \"Ï†ïÏÇ∞ÏòàÏ†ï Í∏àÏï°\"\n        ];\n        newSheetData[1] = [\n            \"\",\n            \"\",\n            \"\",\n            \"\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"\",\n            \"\",\n            \"\",\n            \"\",\n            \"\",\n            \"\",\n            \"Ï¥ù Ï†ÑÏÇ∞Í∏àÏï°\",\n            \"Í≥†Ïö©Î≥¥Ìóò\",\n            \"ÏÇ∞Ïû¨Î≥¥Ìóò\",\n            \"ÏãúÍ∞ÑÏ†úÎ≥¥Ìóò\",\n            \"Î≥¥ÌóòÎ£åÏÜåÍ∏â\",\n            \"\",\n            \"\"\n        ];\n        console.log(\"‚úÖ Ìó§Îçî Ï∂îÍ∞ÄÎê®:\", JSON.stringify(newSheetData[0]), JSON.stringify(newSheetData[1]));\n        // Î≥∏Î¨∏ Îç∞Ïù¥ÌÑ∞ Ï∂îÍ∞Ä (14ÌñâÎ∂ÄÌÑ∞)\n        jsonData.slice(13).forEach((row, index)=>{\n            if (!newSheetData[index + 2]) newSheetData[index + 2] = []; // 2Ï§ÑÏù¥ Ïù¥ÎØ∏ ÏûàÏúºÎØÄÎ°ú index + 2\n            newSheetData[index + 2][0] = row[2]; // CÏó¥\n            newSheetData[index + 2][1] = row[5]; // FÏó¥\n            newSheetData[index + 2][2] = row[6]; // GÏó¥\n            newSheetData[index + 2][3] = row[7]; // HÏó¥\n            newSheetData[index + 2][4] = row[8]; // IÏó¥\n            newSheetData[index + 2][5] = row[9]; // JÏó¥\n            newSheetData[index + 2][6] = row[10]; // KÏó¥\n            newSheetData[index + 2][7] = row[11]; // LÏó¥\n            newSheetData[index + 2][8] = row[12]; // MÏó¥\n            newSheetData[index + 2][9] = row[13]; // NÏó¥\n            newSheetData[index + 2][10] = row[14]; // OÏó¥\n            newSheetData[index + 2][11] = row[15]; // PÏó¥\n            newSheetData[index + 2][12] = row[16]; // QÏó¥\n            newSheetData[index + 2][13] = row[17]; // RÏó¥\n            newSheetData[index + 2][14] = row[18]; // SÏó¥\n            newSheetData[index + 2][15] = row[19]; // TÏó¥\n            newSheetData[index + 2][16] = row[20]; // UÏó¥\n            newSheetData[index + 2][17] = row[21]; // VÏó¥\n            newSheetData[index + 2][18] = row[22]; // WÏó¥\n            newSheetData[index + 2][19] = row[23]; // XÏó¥\n            newSheetData[index + 2][20] = row[24]; // YÏó¥\n            newSheetData[index + 2][21] = row[25]; //ZÏó¥\n            newSheetData[index + 2][22] = row[26]; //AAÏó¥\n            newSheetData[index + 2][23] = row[27]; //ABÏó¥\n            newSheetData[index + 2][27] = row[29]; //ADÏó¥ / ABÏó¥ Í≥†Ïö©Î≥¥Ìóò\n            newSheetData[index + 2][28] = row[31]; //ADÏó¥ / ACÏó¥ ÏÇ∞Ïû¨Î≥¥Ìóò\n            newSheetData[index + 2][29] = row[32]; //ADÏó¥ / ACÏó¥ ÏÇ∞Ïû¨Î≥¥Ìóò\n            // YÏó¥ ÏßÄÏÇ¨ ÌîÑÎ°úÎ™®ÏÖò ÏàòÏãù Ï∂îÍ∞Ä\n            newSheetData[index + 2][24] = {\n                f: `X${index + 3}+IF(B${index + 3}>=180,(B${index + 3}-180)*1000,0)-X${index + 3}`\n            };\n            // AAÏó¥ Í≥ºÏÑ∏Ìï≠Î™© ÏàòÏãù Ï∂îÍ∞Ä\n            newSheetData[index + 2][26] = {\n                f: `X${index + 3}+Y${index + 3}+Z${index + 3}`\n            };\n            // AFÏó¥ ÏõêÏ≤úÏÑ∏ ÏàòÏãù Ï∂îÍ∞Ä\n            newSheetData[index + 2][31] = {\n                f: `((AA${index + 3}+AB${index + 3}+AC${index + 3}+AD${index + 3}+AE${index + 3})*0.967)-(AA${index + 3}+AB${index + 3}+AC${index + 3}+AD${index + 3}+AE${index + 3})`\n            };\n            // AGÏó¥ ÏàòÏãù Ï∂îÍ∞Ä\n            newSheetData[index + 2][32] = {\n                f: `AA${index + 3}+AB${index + 3}+AC${index + 3}+AD${index + 3}+AE${index + 3}+AF${index + 3}`\n            };\n        });\n        console.log(\"‚úÖ Î≥ÄÌôòÎêú Îç∞Ïù¥ÌÑ∞:\", JSON.stringify(newSheetData));\n        const newWorkbook = xlsx__WEBPACK_IMPORTED_MODULE_2__.utils.book_new();\n        const newSheet = xlsx__WEBPACK_IMPORTED_MODULE_2__.utils.aoa_to_sheet(newSheetData);\n        setCellStyles(newSheet); // Ïä§ÌÉÄÏùº Ï†ÅÏö©\n        // üî• Î≥ëÌï© Ï†ïÎ≥¥ Ï∂îÍ∞Ä\n        newSheet[\"!merges\"] = [\n            {\n                s: {\n                    r: 0,\n                    c: 0\n                },\n                e: {\n                    r: 1,\n                    c: 0\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 1\n                },\n                e: {\n                    r: 1,\n                    c: 1\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 2\n                },\n                e: {\n                    r: 1,\n                    c: 2\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 3\n                },\n                e: {\n                    r: 1,\n                    c: 3\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 4\n                },\n                e: {\n                    r: 0,\n                    c: 5\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 6\n                },\n                e: {\n                    r: 0,\n                    c: 7\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 8\n                },\n                e: {\n                    r: 0,\n                    c: 9\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 10\n                },\n                e: {\n                    r: 0,\n                    c: 11\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 12\n                },\n                e: {\n                    r: 0,\n                    c: 13\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 14\n                },\n                e: {\n                    r: 0,\n                    c: 15\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 16\n                },\n                e: {\n                    r: 0,\n                    c: 17\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 18\n                },\n                e: {\n                    r: 0,\n                    c: 19\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 20\n                },\n                e: {\n                    r: 1,\n                    c: 20\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 21\n                },\n                e: {\n                    r: 1,\n                    c: 21\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 22\n                },\n                e: {\n                    r: 1,\n                    c: 22\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 23\n                },\n                e: {\n                    r: 1,\n                    c: 23\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 24\n                },\n                e: {\n                    r: 1,\n                    c: 24\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 25\n                },\n                e: {\n                    r: 1,\n                    c: 25\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 26\n                },\n                e: {\n                    r: 1,\n                    c: 26\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 27\n                },\n                e: {\n                    r: 0,\n                    c: 30\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 31\n                },\n                e: {\n                    r: 1,\n                    c: 31\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 32\n                },\n                e: {\n                    r: 1,\n                    c: 32\n                }\n            }\n        ];\n        // Ïó¥ ÎÑàÎπÑ ÏûêÎèô Ï°∞Ï†à Ï†ÅÏö©\n        autoFitColumns(newSheet, newSheetData);\n        // ÏóëÏÖÄ ÌååÏùº Ï†ÄÏû•\n        xlsx__WEBPACK_IMPORTED_MODULE_2__.utils.book_append_sheet(newWorkbook, newSheet, \"Formatted\");\n        const formattedFilePath = decryptedFilePath.replace(\".xlsx\", \"_formatted.xlsx\");\n        xlsx__WEBPACK_IMPORTED_MODULE_2__.writeFile(newWorkbook, formattedFilePath);\n        console.log(\"‚úÖ Formatted file saved:\", formattedFilePath);\n        res.setHeader(\"Content-Disposition\", \"attachment; filename=formatted.xlsx\");\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        const fileBuffer = fs__WEBPACK_IMPORTED_MODULE_1___default().readFileSync(formattedFilePath);\n        res.status(200).send(fileBuffer);\n    } catch (error) {\n        console.error(\"‚ùå Processing error:\", error);\n        res.status(500).json({\n            error: \"Failed to process the file\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUcsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsRUFBRSxHQUFHNUQsR0FBRyxDQUFDLEVBQUUsRUFBRyxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEVBQUUsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsRUFBRSxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBRSxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUMsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FBRyxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBQyxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFDLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUMsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FBRyxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBQyxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFDLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUMsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FB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QUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1lBQ3pDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7WUFDekM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1lBQ3pDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7WUFDekM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1lBQ3pDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7WUFDekM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1lBQ3pDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7U0FDMUM7UUFDRCxnQkFBZ0I7UUFDaEI3RSxlQUFleUUsVUFBVVI7UUFFekIsV0FBVztRQUNYMUUsdUNBQVUsQ0FBQ3dGLGlCQUFpQixDQUFDUixhQUFhRSxVQUFVO1FBRXBELE1BQU1PLG9CQUFvQi9CLGtCQUFrQkMsT0FBTyxDQUFDLFNBQVM7UUFDN0QzRCwyQ0FBYyxDQUFDZ0YsYUFBYVM7UUFFNUJqQyxRQUFRQyxHQUFHLENBQUMsMkJBQTJCZ0M7UUFFdkMxQyxJQUFJNEMsU0FBUyxDQUFDLHVCQUF1QjtRQUNyQzVDLElBQUk0QyxTQUFTLENBQUMsZ0JBQWdCO1FBRTlCLE1BQU1DLGFBQWE3RixzREFBZSxDQUFDMEY7UUFDbkMxQyxJQUFJRSxNQUFNLENBQUMsS0FBSzZDLElBQUksQ0FBQ0Y7SUFDdkIsRUFBRSxPQUFPekMsT0FBTztRQUNkSyxRQUFRTCxLQUFLLENBQUMsdUJBQXVCQTtRQUNyQ0osSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQTZCO0lBQzdEO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9ldW5qaWxlZS9EZXZlbG9wbWVudC9kb2RvL3BhZ2VzL2FwaS9mb3JtYXQtZXhjZWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgZm9ybWlkYWJsZSBmcm9tIFwiZm9ybWlkYWJsZVwiO1xuaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0ICogYXMgWExTWCBmcm9tIFwieGxzeFwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gXCJ1dGlsXCI7XG5pbXBvcnQgeyBleGVjIH0gZnJvbSBcImNoaWxkX3Byb2Nlc3NcIjtcblxuY29uc3QgUFlUSE9OX1BBVEggPSBwcm9jZXNzLmVudi5QWVRIT05fUEFUSCB8fCBcInB5dGhvbjNcIjtcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgYXBpOiB7XG4gICAgYm9keVBhcnNlcjogZmFsc2UsXG4gIH0sXG59O1xuXG4vLyDshYAg7YGs6riwIOyekOuPmSDsobDsoIgg7ZWo7IiYXG5jb25zdCBhdXRvRml0Q29sdW1ucyA9ICh3b3Jrc2hlZXQ6IFhMU1guV29ya1NoZWV0LCBkYXRhOiBhbnlbXVtdKSA9PiB7XG4gIGNvbnN0IGNvbHVtbldpZHRocyA9IGRhdGFbMF0ubWFwKChfLCBjb2xJbmRleCkgPT4ge1xuICAgIHJldHVybiBNYXRoLm1heChcbiAgICAgIC4uLmRhdGEubWFwKChyb3cpID0+IChyb3dbY29sSW5kZXhdID8gcm93W2NvbEluZGV4XS50b1N0cmluZygpLmxlbmd0aCA6IDEwKSlcbiAgICApO1xuICB9KTtcblxuICB3b3Jrc2hlZXRbXCIhY29sc1wiXSA9IGNvbHVtbldpZHRocy5tYXAoKHdpZHRoKSA9PiAoeyB3Y2g6IHdpZHRoICsgMiB9KSk7XG59O1xuXG4vLyDshYAg7Iqk7YOA7J28IOyEpOyglSDtlajsiJhcbmNvbnN0IHNldENlbGxTdHlsZXMgPSAod29ya3NoZWV0OiBYTFNYLldvcmtTaGVldCkgPT4ge1xuICBjb25zdCBjb2x1bW5zVG9Gb3JtYXQgPSBbXG4gICAgJ0MnLCAnRCcsICdGJywgJ0gnLCAnSicsICdMJywgJ04nLCAnUCcsICdSJywgJ1QnLCAnVScsICdWJywgJ1cnLCAnWCcsICdZJywgJ1onLCBcbiAgICAsICdBQicsICdBQycsICdBRCcsICdBRScsICdBRicsICdBRydcbiAgXTtcblxuICBjb25zdCBtYXhSb3cgPSB3b3Jrc2hlZXRbJyFyZWYnXSA/IHBhcnNlSW50KHdvcmtzaGVldFsnIXJlZiddLnNwbGl0KCc6JylbMV0ubWF0Y2goL1xcZCsvKT8uWzBdIHx8IFwiMlwiKSA6IDI7XG5cbiAgY29sdW1uc1RvRm9ybWF0LmZvckVhY2goKGNvbCkgPT4ge1xuICAgIGZvciAobGV0IHJvdyA9IDI7IHJvdyA8PSBtYXhSb3c7IHJvdysrKSB7XG4gICAgICBjb25zdCBjZWxsQWRkcmVzcyA9IGAke2NvbH0ke3Jvd31gO1xuICAgICAgaWYgKHdvcmtzaGVldFtjZWxsQWRkcmVzc10pIHtcbiAgICAgICAgd29ya3NoZWV0W2NlbGxBZGRyZXNzXS56ID0gJyMsIyMwJzsgLy8g7Iir7J6QIO2YleyLnTogM+yekOumrOuniOuLpCDsvaTrp4hcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgcGFyc2VGb3JtID0gYXN5bmMgKHJlcTogTmV4dEFwaVJlcXVlc3QpOiBQcm9taXNlPHsgZmlsZXM6IGZvcm1pZGFibGUuRmlsZXMgfT4gPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IGZvcm0gPSBmb3JtaWRhYmxlKHsgbXVsdGlwbGVzOiBmYWxzZSwgdXBsb2FkRGlyOiBcIi90bXBcIiwga2VlcEV4dGVuc2lvbnM6IHRydWUgfSk7XG5cbiAgICBmb3JtLnBhcnNlKHJlcSwgKGVyciwgZmllbGRzLCBmaWxlcykgPT4ge1xuICAgICAgaWYgKGVycikgcmVqZWN0KGVycik7XG4gICAgICBlbHNlIHJlc29sdmUoeyBmaWxlcyB9KTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSBcIlBPU1RcIikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiBcIk1ldGhvZCBOb3QgQWxsb3dlZFwiIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IGZpbGVzIH0gPSBhd2FpdCBwYXJzZUZvcm0ocmVxKTtcbiAgICBpZiAoIWZpbGVzLmZpbGUpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBcIkZpbGUgbm90IGZvdW5kIG9yIGludmFsaWQgZmlsZVwiIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGZpbGUgPSBBcnJheS5pc0FycmF5KGZpbGVzLmZpbGUpID8gZmlsZXMuZmlsZVswXSA6IChmaWxlcy5maWxlIGFzIGZvcm1pZGFibGUuRmlsZSk7XG4gICAgaWYgKCFmaWxlLmZpbGVwYXRoKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogXCJJbnZhbGlkIGZpbGUgcGF0aFwiIH0pO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwi8J+TjCBQcm9jZXNzaW5nIGVuY3J5cHRlZCBmaWxlOlwiLCBmaWxlLmZpbGVwYXRoKTtcblxuICAgIGNvbnN0IGRlY3J5cHRlZEZpbGVQYXRoID0gZmlsZS5maWxlcGF0aC5yZXBsYWNlKFwiLnhsc3hcIiwgXCJfZGVjcnlwdGVkLnhsc3hcIik7XG5cbiAgICBjb25zdCBjb21tYW5kID0gYCR7UFlUSE9OX1BBVEh9IGRlY3J5cHRfZXhjZWwucHkgXCIke2ZpbGUuZmlsZXBhdGh9XCIgXCIke2RlY3J5cHRlZEZpbGVQYXRofVwiYDtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBzdGRvdXQsIHN0ZGVyciB9ID0gYXdhaXQgcHJvbWlzaWZ5KGV4ZWMpKGNvbW1hbmQpO1xuICAgICAgY29uc29sZS5sb2coXCLwn5OMIFB5dGhvbiBPdXRwdXQ6XCIsIHN0ZG91dCk7XG4gICAgICBjb25zb2xlLmVycm9yKFwi8J+TjCBQeXRob24gRXJyb3I6XCIsIHN0ZGVycik7XG5cbiAgICAgIGlmICghZnMuZXhpc3RzU3luYyhkZWNyeXB0ZWRGaWxlUGF0aCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGDinYwgRGVjcnlwdGVkIGZpbGUgbm90IGZvdW5kOiAke2RlY3J5cHRlZEZpbGVQYXRofWApO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBEZWNyeXB0ZWQgZmlsZSBjcmVhdGVkOlwiLCBkZWNyeXB0ZWRGaWxlUGF0aCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRmFpbGVkIHRvIGRlY3J5cHQgZmlsZTpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IFwiRmFpbGVkIHRvIGRlY3J5cHQgZmlsZS4gQ2hlY2sgcGFzc3dvcmQgb3IgZW5jcnlwdGlvbiB0eXBlLlwiIH0pO1xuICAgIH1cblxuICAgIC8vIOyVlO2YuCDtlbTsoJzrkJwg7YyM7J287J2EIOydveq4sFxuICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkRmlsZShkZWNyeXB0ZWRGaWxlUGF0aCk7XG4gICAgY29uc3Qgc2hlZXQgPSB3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1swXV07XG4gICAgY29uc3QganNvbkRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24oc2hlZXQsIHsgaGVhZGVyOiAxIH0pO1xuXG4gICAgY29uc29sZS5sb2coXCLinIUgRXhjZWwgZGF0YSBsb2FkZWQ6XCIsIGpzb25EYXRhLmxlbmd0aCk7XG5cbiAgICAvLyDsg4jroZzsmrQg7Iuc7Yq4IOuNsOydtO2EsCDsg53shLFcbiAgICBjb25zdCBuZXdTaGVldERhdGE6IGFueVtdW10gPSBbXTtcblxuICAgIC8vIOqzoOygleuQnCDsu6TsiqTthYAg7Zek642UIOyEpOyglVxuICAgIG5ld1NoZWV0RGF0YVswXSA9IFtcbiAgICAgIFwi7ISx7ZWoXCIsIFwi7LSdIOyYpOuNlOyImFwiLCBcIuq4sOuzuCDquIjslaFcIiwgXCLsp4Dsl63ri6jqsIBcIiwgXCLrsLDri6zqsbDrpqwg7ZWg7KadXCIsIFwiXCIsIFwi7ZS97JeF7KeAIO2VoOymnVwiLCBcIlwiLCBcIuuPhOywqeyngCDtlaDspp1cIiwgXCJcIiwgXG4gICAgICBcIuq4sOyDgSDtlaDspp1cIiwgXCJcIiwgXCLquLDtg4Ag7ZSE66Gc66qo7IWYIDFcIiwgXCJcIiwgXCLquLDtg4Ag7ZSE66Gc66qo7IWYIDJcIiwgXCJcIiwgXCLquLDtg4Ag7ZSE66Gc66qo7IWYIDNcIiwgXCJcIiwgXCLquLDtg4Ag7ZSE66Gc66qo7IWYIDRcIiwgXCJcIiwgXG4gICAgICBcIuygleyCsOq4iOyVoVwiLCBcIuy0nSDsp4Dsm5DquIhcIiwgXCLssKjqsJDrgrTsl61cIiwgXCLtlanqs4TquIjslaFcIiwgXCLsp4Dsgqwg7ZSE66Gc66qo7IWYXCIsIFwi7JW86rCEIO2UhOuhnOuqqOyFmFwiLCBcIuqzvOyEuCDtla3rqqlcIiwgXCLruYTqs7zshLgg7ZWt66qpXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwi7JuQ7LKc7IS4XCIsIFwi7KCV7IKw7JiI7KCVIOq4iOyVoVwiXG4gICAgXTtcbiAgICBcbiAgICBuZXdTaGVldERhdGFbMV0gPSBbXG4gICAgICBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIuyYpOuNlCDsiJhcIiwgXCLquIjslaFcIiwgXCLsmKTrjZQg7IiYXCIsIFwi6riI7JWhXCIsIFwi7Jik642UIOyImFwiLCBcIuq4iOyVoVwiLCBcbiAgICAgIFwi7Jik642UIOyImFwiLCBcIuq4iOyVoVwiLCBcIuyYpOuNlCDsiJhcIiwgXCLquIjslaFcIiwgXCLsmKTrjZQg7IiYXCIsIFwi6riI7JWhXCIsIFwi7Jik642UIOyImFwiLCBcIuq4iOyVoVwiLCBcIuyYpOuNlCDsiJhcIiwgXCLquIjslaFcIiwgXG4gICAgICBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIuy0nSDsoITsgrDquIjslaFcIiwgXCLqs6Dsmqnrs7Ttl5hcIiwgXCLsgrDsnqzrs7Ttl5hcIiwgXCLsi5zqsITsoJzrs7Ttl5hcIiwgXCLrs7Ttl5jro4zshozquIlcIiwgXCJcIiwgXCJcIlxuICAgIF07XG5cbiAgICBjb25zb2xlLmxvZyhcIuKchSDtl6TrjZQg7LaU6rCA65CoOlwiLCBKU09OLnN0cmluZ2lmeShuZXdTaGVldERhdGFbMF0pLCBKU09OLnN0cmluZ2lmeShuZXdTaGVldERhdGFbMV0pKTtcblxuICAgIC8vIOuzuOusuCDrjbDsnbTthLAg7LaU6rCAICgxNO2Wieu2gO2EsClcbiAgICBqc29uRGF0YS5zbGljZSgxMykuZm9yRWFjaCgocm93LCBpbmRleCkgPT4ge1xuICAgICAgaWYgKCFuZXdTaGVldERhdGFbaW5kZXggKyAyXSkgbmV3U2hlZXREYXRhW2luZGV4ICsgMl0gPSBbXTsgLy8gMuykhOydtCDsnbTrr7gg7J6I7Jy866+A66GcIGluZGV4ICsgMlxuXG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVswXSA9IHJvd1syXTsgIC8vIEPsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzFdID0gcm93WzVdOyAgLy8gRuyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMl0gPSByb3dbNl07ICAvLyBH7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVszXSA9IHJvd1s3XTsgIC8vIEjsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzRdID0gcm93WzhdOyAgLy8gSeyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bNV0gPSByb3dbOV07ICAvLyBK7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVs2XSA9IHJvd1sxMF07IC8vIEvsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzddID0gcm93WzExXTsgLy8gTOyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bOF0gPSByb3dbMTJdOyAvLyBN7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVs5XSA9IHJvd1sxM107IC8vIE7sl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzEwXSA9IHJvd1sxNF07Ly8gT+yXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMTFdID0gcm93WzE1XTsvLyBQ7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsxMl0gPSByb3dbMTZdOy8vIFHsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzEzXSA9IHJvd1sxN107Ly8gUuyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMTRdID0gcm93WzE4XTsvLyBT7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsxNV0gPSByb3dbMTldOy8vIFTsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzE2XSA9IHJvd1syMF07Ly8gVeyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMTddID0gcm93WzIxXTsvLyBW7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsxOF0gPSByb3dbMjJdOy8vIFfsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzE5XSA9IHJvd1syM107Ly8gWOyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMjBdID0gcm93WzI0XTsvLyBZ7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsyMV0gPSByb3dbMjVdOyAvL1rsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzIyXSA9IHJvd1syNl07IC8vQUHsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzIzXSA9IHJvd1syN107IC8vQULsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzI3XSA9IHJvd1syOV07IC8vQUTsl7QgLyBBQuyXtCDqs6Dsmqnrs7Ttl5hcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzI4XSA9IHJvd1szMV07IC8vQUTsl7QgLyBBQ+yXtCDsgrDsnqzrs7Ttl5hcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzI5XSA9IHJvd1szMl07IC8vQUTsl7QgLyBBQ+yXtCDsgrDsnqzrs7Ttl5hcblxuICAgICAgLy8gWeyXtCDsp4Dsgqwg7ZSE66Gc66qo7IWYIOyImOyLnSDstpTqsIBcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzI0XSA9IHtcbiAgICAgICAgZjogYFgke2luZGV4ICsgM30rSUYoQiR7aW5kZXggKyAzfT49MTgwLChCJHtpbmRleCArIDN9LTE4MCkqMTAwMCwwKS1YJHtpbmRleCArIDN9YFxuICAgICAgfTtcblxuICAgICAgLy8gQUHsl7Qg6rO87IS47ZWt66qpIOyImOyLnSDstpTqsIBcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzI2XSA9IHtcbiAgICAgICAgZjogYFgke2luZGV4ICsgM30rWSR7aW5kZXggKyAzfStaJHtpbmRleCArIDN9YFxuICAgICAgfTtcblxuICAgICAgLy8gQUbsl7Qg7JuQ7LKc7IS4IOyImOyLnSDstpTqsIBcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzMxXSA9IHtcbiAgICAgICAgZjogYCgoQUEke2luZGV4ICsgM30rQUIke2luZGV4ICsgM30rQUMke2luZGV4ICsgM30rQUQke2luZGV4ICsgM30rQUUke2luZGV4ICsgM30pKjAuOTY3KS0oQUEke2luZGV4ICsgM30rQUIke2luZGV4ICsgM30rQUMke2luZGV4ICsgM30rQUQke2luZGV4ICsgM30rQUUke2luZGV4ICsgM30pYFxuICAgICAgfTtcblxuICAgICAgLy8gQUfsl7Qg7IiY7IudIOy2lOqwgFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMzJdID0ge1xuICAgICAgICBmOiBgQUEke2luZGV4ICsgM30rQUIke2luZGV4ICsgM30rQUMke2luZGV4ICsgM30rQUQke2luZGV4ICsgM30rQUUke2luZGV4ICsgM30rQUYke2luZGV4ICsgM31gXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coXCLinIUg67OA7ZmY65CcIOuNsOydtO2EsDpcIiwgSlNPTi5zdHJpbmdpZnkobmV3U2hlZXREYXRhKSk7XG5cbiAgICBjb25zdCBuZXdXb3JrYm9vayA9IFhMU1gudXRpbHMuYm9va19uZXcoKTtcbiAgICBjb25zdCBuZXdTaGVldCA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KG5ld1NoZWV0RGF0YSk7XG4gICAgc2V0Q2VsbFN0eWxlcyhuZXdTaGVldCk7IC8vIOyKpO2DgOydvCDsoIHsmqlcbiAgICAvLyDwn5SlIOuzke2VqSDsoJXrs7Qg7LaU6rCAXG4gICAgbmV3U2hlZXRbXCIhbWVyZ2VzXCJdID0gW1xuICAgICAgeyBzOiB7IHI6IDAsIGM6IDAgfSwgZTogeyByOiAxLCBjOiAwIH0gfSwgLy8g7ISx7ZWoICjshLjroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDEgfSwgZTogeyByOiAxLCBjOiAxIH0gfSwgLy8g7LSdIOyYpOuNlOyImCAo7IS466GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAyIH0sIGU6IHsgcjogMSwgYzogMiB9IH0sIC8vIOq4sOuzuCDquIjslaEgKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMyB9LCBlOiB7IHI6IDEsIGM6IDMgfSB9LCAvLyDsp4Dsl63ri6jqsIAgKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogNCB9LCBlOiB7IHI6IDAsIGM6IDUgfSB9LCAvLyDrsLDri6zqsbDrpqwg7ZWg7KadICjqsIDroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDYgfSwgZTogeyByOiAwLCBjOiA3IH0gfSwgLy8g7ZS97JeF7KeAIO2VoOymnSAo6rCA66GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiA4IH0sIGU6IHsgcjogMCwgYzogOSB9IH0sIC8vIOuPhOywqeyngCDtlaDspp0gKOqwgOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMTAgfSwgZTogeyByOiAwLCBjOiAxMSB9IH0sIC8vIOq4sOyDgSDtlaDspp0gKOqwgOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMTIgfSwgZTogeyByOiAwLCBjOiAxMyB9IH0sIC8vIOq4sO2DgCDtlITroZzrqqjshZggMSAo6rCA66GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAxNCB9LCBlOiB7IHI6IDAsIGM6IDE1IH0gfSwgLy8g6riw7YOAIO2UhOuhnOuqqOyFmCAyICjqsIDroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDE2IH0sIGU6IHsgcjogMCwgYzogMTcgfSB9LCAvLyDquLDtg4Ag7ZSE66Gc66qo7IWYIDMgKOqwgOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMTggfSwgZTogeyByOiAwLCBjOiAxOSB9IH0sIC8vIOq4sO2DgCDtlITroZzrqqjshZggNCAo6rCA66GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAyMCB9LCBlOiB7IHI6IDEsIGM6IDIwIH0gfSwgLy8g7KCV7IKw6riI7JWhICjshLjroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDIxIH0sIGU6IHsgcjogMSwgYzogMjEgfSB9LCAvLyDstJ0g7KeA7JuQ6riIICjshLjroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDIyIH0sIGU6IHsgcjogMSwgYzogMjIgfSB9LCAvLyDssKjqsJDrgrTsl60gKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMjMgfSwgZTogeyByOiAxLCBjOiAyMyB9IH0sIC8vIO2VqeqzhOq4iOyVoSAo7IS466GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAyNCB9LCBlOiB7IHI6IDEsIGM6IDI0IH0gfSwgLy8g7KeA7IKsIO2UhOuhnOuqqOyFmCAo7IS466GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAyNSB9LCBlOiB7IHI6IDEsIGM6IDI1IH0gfSwgLy8g7JW86rCEIO2UhOuhnOuqqOyFmCAo7IS466GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAyNiB9LCBlOiB7IHI6IDEsIGM6IDI2IH0gfSwgLy8g6rO87IS4IO2VreuqqSAvIOy0nSDsoITsgrDquIjslaEgKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMjcgfSwgZTogeyByOiAwLCBjOiAzMCB9IH0sIC8vIOu5hOqzvOyEuCDtla3rqqkgKOqwgOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMzEgfSwgZTogeyByOiAxLCBjOiAzMSB9IH0sIC8vIOybkOyynOyEuCAo7IS466GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAzMiB9LCBlOiB7IHI6IDEsIGM6IDMyIH0gfSwgLy8g7KCV7IKw7JiI7KCVIOq4iOyVoSAo7IS466GcIOuzke2VqSlcbiAgICBdO1xuICAgIC8vIOyXtCDrhIjruYQg7J6Q64+ZIOyhsOygiCDsoIHsmqlcbiAgICBhdXRvRml0Q29sdW1ucyhuZXdTaGVldCwgbmV3U2hlZXREYXRhKTtcblxuICAgIC8vIOyXkeyFgCDtjIzsnbwg7KCA7J6lXG4gICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldChuZXdXb3JrYm9vaywgbmV3U2hlZXQsIFwiRm9ybWF0dGVkXCIpO1xuXG4gICAgY29uc3QgZm9ybWF0dGVkRmlsZVBhdGggPSBkZWNyeXB0ZWRGaWxlUGF0aC5yZXBsYWNlKFwiLnhsc3hcIiwgXCJfZm9ybWF0dGVkLnhsc3hcIik7XG4gICAgWExTWC53cml0ZUZpbGUobmV3V29ya2Jvb2ssIGZvcm1hdHRlZEZpbGVQYXRoKTtcblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIEZvcm1hdHRlZCBmaWxlIHNhdmVkOlwiLCBmb3JtYXR0ZWRGaWxlUGF0aCk7XG5cbiAgICByZXMuc2V0SGVhZGVyKFwiQ29udGVudC1EaXNwb3NpdGlvblwiLCBcImF0dGFjaG1lbnQ7IGZpbGVuYW1lPWZvcm1hdHRlZC54bHN4XCIpO1xuICAgIHJlcy5zZXRIZWFkZXIoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldFwiKTtcblxuICAgIGNvbnN0IGZpbGVCdWZmZXIgPSBmcy5yZWFkRmlsZVN5bmMoZm9ybWF0dGVkRmlsZVBhdGgpO1xuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKGZpbGVCdWZmZXIpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgUHJvY2Vzc2luZyBlcnJvcjpcIiwgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IFwiRmFpbGVkIHRvIHByb2Nlc3MgdGhlIGZpbGVcIiB9KTtcbiAgfVxufTsiXSwibmFtZXMiOlsiZm9ybWlkYWJsZSIsImZzIiwiWExTWCIsInByb21pc2lmeSIsImV4ZWMiLCJQWVRIT05fUEFUSCIsInByb2Nlc3MiLCJlbnYiLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwiYXV0b0ZpdENvbHVtbnMiLCJ3b3Jrc2hlZXQiLCJkYXRhIiwiY29sdW1uV2lkdGhzIiwibWFwIiwiXyIsImNvbEluZGV4IiwiTWF0aCIsIm1heCIsInJvdyIsInRvU3RyaW5nIiwibGVuZ3RoIiwid2lkdGgiLCJ3Y2giLCJzZXRDZWxsU3R5bGVzIiwiY29sdW1uc1RvRm9ybWF0IiwibWF4Um93IiwicGFyc2VJbnQiLCJzcGxpdCIsIm1hdGNoIiwiZm9yRWFjaCIsImNvbCIsImNlbGxBZGRyZXNzIiwieiIsInBhcnNlRm9ybSIsInJlcSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZm9ybSIsIm11bHRpcGxlcyIsInVwbG9hZERpciIsImtlZXBFeHRlbnNpb25zIiwicGFyc2UiLCJlcnIiLCJmaWVsZHMiLCJmaWxlcyIsImhhbmRsZXIiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJmaWxlIiwiQXJyYXkiLCJpc0FycmF5IiwiZmlsZXBhdGgiLCJjb25zb2xlIiwibG9nIiwiZGVjcnlwdGVkRmlsZVBhdGgiLCJyZXBsYWNlIiwiY29tbWFuZCIsInN0ZG91dCIsInN0ZGVyciIsImV4aXN0c1N5bmMiLCJFcnJvciIsIndvcmtib29rIiwicmVhZEZpbGUiLCJzaGVldCIsIlNoZWV0cyIsIlNoZWV0TmFtZXMiLCJqc29uRGF0YSIsInV0aWxzIiwic2hlZXRfdG9fanNvbiIsImhlYWRlciIsIm5ld1NoZWV0RGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzbGljZSIsImluZGV4IiwiZiIsIm5ld1dvcmtib29rIiwiYm9va19uZXciLCJuZXdTaGVldCIsImFvYV90b19zaGVldCIsInMiLCJyIiwiYyIsImUiLCJib29rX2FwcGVuZF9zaGVldCIsImZvcm1hdHRlZEZpbGVQYXRoIiwid3JpdGVGaWxlIiwic2V0SGVhZGVyIiwiZmlsZUJ1ZmZlciIsInJlYWRGaWxlU3luYyIsInNlbmQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/format-excel.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fformat-excel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fformat-excel.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();