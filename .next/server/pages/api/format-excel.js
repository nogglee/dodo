"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/format-excel";
exports.ids = ["pages/api/format-excel"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "xlsx":
/*!***********************!*\
  !*** external "xlsx" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("xlsx");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fformat-excel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fformat-excel.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fformat-excel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fformat-excel.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/format-excel.ts */ \"(api)/./pages/api/format-excel.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/format-excel\",\n        pathname: \"/api/format-excel\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_format_excel_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmZvcm1hdC1leGNlbCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGZm9ybWF0LWV4Y2VsLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQ3dEO0FBQ3hEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvZm9ybWF0LWV4Y2VsLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9mb3JtYXQtZXhjZWxcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9mb3JtYXQtZXhjZWxcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fformat-excel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fformat-excel.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/format-excel.ts":
/*!***********************************!*\
  !*** ./pages/api/format-excel.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! xlsx */ \"xlsx\");\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_4__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_0__]);\nformidable__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\nconst PYTHON_PATH = \"/Users/eunjilee/.venvs/dodo_env/bin/python3\";\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\n// ÏÖÄ ÌÅ¨Í∏∞ ÏûêÎèô Ï°∞Ï†à Ìï®Ïàò\nconst autoFitColumns = (worksheet, data)=>{\n    const columnWidths = data[0].map((_, colIndex)=>{\n        return Math.max(...data.map((row)=>row[colIndex] ? row[colIndex].toString().length : 10));\n    });\n    worksheet[\"!cols\"] = columnWidths.map((width)=>({\n            wch: width + 2\n        }));\n};\n// ÏÖÄ Ïä§ÌÉÄÏùº ÏÑ§Ï†ï Ìï®Ïàò\nconst setCellStyles = (worksheet)=>{\n    const columnsToFormat = [\n        'C',\n        'D',\n        'F',\n        'H',\n        'J',\n        'L',\n        'N',\n        'P',\n        'R',\n        'T',\n        'U',\n        'V',\n        'W',\n        'X',\n        'Y',\n        'Z',\n        ,\n        'AB',\n        'AC',\n        'AD',\n        'AE',\n        'AF',\n        'AG'\n    ];\n    const maxRow = worksheet['!ref'] ? parseInt(worksheet['!ref'].split(':')[1].match(/\\d+/)?.[0] || \"2\") : 2;\n    columnsToFormat.forEach((col)=>{\n        for(let row = 2; row <= maxRow; row++){\n            const cellAddress = `${col}${row}`;\n            if (worksheet[cellAddress]) {\n                worksheet[cellAddress].z = '#,##0'; // Ïà´Ïûê ÌòïÏãù: 3ÏûêÎ¶¨ÎßàÎã§ ÏΩ§Îßà\n            }\n        }\n    });\n};\nconst parseForm = async (req)=>{\n    return new Promise((resolve, reject)=>{\n        const form = (0,formidable__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            multiples: false,\n            uploadDir: \"/tmp\",\n            keepExtensions: true\n        });\n        form.parse(req, (err, fields, files)=>{\n            if (err) reject(err);\n            else resolve({\n                files\n            });\n        });\n    });\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method Not Allowed\"\n        });\n    }\n    try {\n        const { files } = await parseForm(req);\n        if (!files.file) {\n            return res.status(400).json({\n                error: \"File not found or invalid file\"\n            });\n        }\n        const file = Array.isArray(files.file) ? files.file[0] : files.file;\n        if (!file.filepath) {\n            return res.status(400).json({\n                error: \"Invalid file path\"\n            });\n        }\n        console.log(\"üìå Processing encrypted file:\", file.filepath);\n        const decryptedFilePath = file.filepath.replace(\".xlsx\", \"_decrypted.xlsx\");\n        const command = `${PYTHON_PATH} decrypt_excel.py \"${file.filepath}\" \"${decryptedFilePath}\"`;\n        try {\n            const { stdout, stderr } = await (0,util__WEBPACK_IMPORTED_MODULE_3__.promisify)(child_process__WEBPACK_IMPORTED_MODULE_4__.exec)(command);\n            console.log(\"üìå Python Output:\", stdout);\n            console.error(\"üìå Python Error:\", stderr);\n            if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(decryptedFilePath)) {\n                throw new Error(`‚ùå Decrypted file not found: ${decryptedFilePath}`);\n            }\n            console.log(\"‚úÖ Decrypted file created:\", decryptedFilePath);\n        } catch (error) {\n            console.error(\"‚ùå Failed to decrypt file:\", error);\n            return res.status(500).json({\n                error: \"Failed to decrypt file. Check password or encryption type.\"\n            });\n        }\n        // ÏïîÌò∏ Ìï¥Ï†úÎêú ÌååÏùºÏùÑ ÏùΩÍ∏∞\n        const workbook = xlsx__WEBPACK_IMPORTED_MODULE_2__.readFile(decryptedFilePath);\n        const sheet = workbook.Sheets[workbook.SheetNames[0]];\n        const jsonData = xlsx__WEBPACK_IMPORTED_MODULE_2__.utils.sheet_to_json(sheet, {\n            header: 1\n        });\n        console.log(\"‚úÖ Excel data loaded:\", jsonData.length);\n        // ÏÉàÎ°úÏö¥ ÏãúÌä∏ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±\n        const newSheetData = [];\n        // Í≥†Ï†ïÎêú Ïª§Ïä§ÌÖÄ Ìó§Îçî ÏÑ§Ï†ï\n        newSheetData[0] = [\n            \"ÏÑ±Ìï®\",\n            \"Ï¥ù Ïò§ÎçîÏàò\",\n            \"Í∏∞Î≥∏ Í∏àÏï°\",\n            \"ÏßÄÏó≠Îã®Í∞Ä\",\n            \"Î∞∞Îã¨Í±∞Î¶¨ Ìï†Ï¶ù\",\n            \"\",\n            \"ÌîΩÏóÖÏßÄ Ìï†Ï¶ù\",\n            \"\",\n            \"ÎèÑÏ∞©ÏßÄ Ìï†Ï¶ù\",\n            \"\",\n            \"Í∏∞ÏÉÅ Ìï†Ï¶ù\",\n            \"\",\n            \"Í∏∞ÌÉÄ ÌîÑÎ°úÎ™®ÏÖò 1\",\n            \"\",\n            \"Í∏∞ÌÉÄ ÌîÑÎ°úÎ™®ÏÖò 2\",\n            \"\",\n            \"Í∏∞ÌÉÄ ÌîÑÎ°úÎ™®ÏÖò 3\",\n            \"\",\n            \"Í∏∞ÌÉÄ ÌîÑÎ°úÎ™®ÏÖò 4\",\n            \"\",\n            \"Ï†ïÏÇ∞Í∏àÏï°\",\n            \"Ï¥ù ÏßÄÏõêÍ∏à\",\n            \"Ï∞®Í∞êÎÇ¥Ïó≠\",\n            \"Ìï©Í≥ÑÍ∏àÏï°\",\n            \"ÏßÄÏÇ¨ ÌîÑÎ°úÎ™®ÏÖò\",\n            \"ÏïºÍ∞Ñ ÌîÑÎ°úÎ™®ÏÖò\",\n            \"Í≥ºÏÑ∏ Ìï≠Î™©\",\n            \"ÎπÑÍ≥ºÏÑ∏ Ìï≠Î™©\",\n            \"\",\n            \"\",\n            \"\",\n            \"ÏõêÏ≤úÏÑ∏\",\n            \"Ï†ïÏÇ∞ÏòàÏ†ï Í∏àÏï°\"\n        ];\n        newSheetData[1] = [\n            \"\",\n            \"\",\n            \"\",\n            \"\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"Ïò§Îçî Ïàò\",\n            \"Í∏àÏï°\",\n            \"\",\n            \"\",\n            \"\",\n            \"\",\n            \"\",\n            \"\",\n            \"Ï¥ù Ï†ÑÏÇ∞Í∏àÏï°\",\n            \"Í≥†Ïö©Î≥¥Ìóò\",\n            \"ÏÇ∞Ïû¨Î≥¥Ìóò\",\n            \"ÏãúÍ∞ÑÏ†úÎ≥¥Ìóò\",\n            \"Î≥¥ÌóòÎ£åÏÜåÍ∏â\",\n            \"\",\n            \"\"\n        ];\n        console.log(\"‚úÖ Ìó§Îçî Ï∂îÍ∞ÄÎê®:\", JSON.stringify(newSheetData[0]), JSON.stringify(newSheetData[1]));\n        // Î≥∏Î¨∏ Îç∞Ïù¥ÌÑ∞ Ï∂îÍ∞Ä (14ÌñâÎ∂ÄÌÑ∞)\n        jsonData.slice(13).forEach((row, index)=>{\n            if (!newSheetData[index + 2]) newSheetData[index + 2] = []; // 2Ï§ÑÏù¥ Ïù¥ÎØ∏ ÏûàÏúºÎØÄÎ°ú index + 2\n            newSheetData[index + 2][0] = row[2]; // CÏó¥\n            newSheetData[index + 2][1] = row[5]; // FÏó¥\n            newSheetData[index + 2][2] = row[6]; // GÏó¥\n            newSheetData[index + 2][3] = row[7]; // HÏó¥\n            newSheetData[index + 2][4] = row[8]; // IÏó¥\n            newSheetData[index + 2][5] = row[9]; // JÏó¥\n            newSheetData[index + 2][6] = row[10]; // KÏó¥\n            newSheetData[index + 2][7] = row[11]; // LÏó¥\n            newSheetData[index + 2][8] = row[12]; // MÏó¥\n            newSheetData[index + 2][9] = row[13]; // NÏó¥\n            newSheetData[index + 2][10] = row[14]; // OÏó¥\n            newSheetData[index + 2][11] = row[15]; // PÏó¥\n            newSheetData[index + 2][12] = row[16]; // QÏó¥\n            newSheetData[index + 2][13] = row[17]; // RÏó¥\n            newSheetData[index + 2][14] = row[18]; // SÏó¥\n            newSheetData[index + 2][15] = row[19]; // TÏó¥\n            newSheetData[index + 2][16] = row[20]; // UÏó¥\n            newSheetData[index + 2][17] = row[21]; // VÏó¥\n            newSheetData[index + 2][18] = row[22]; // WÏó¥\n            newSheetData[index + 2][19] = row[23]; // XÏó¥\n            newSheetData[index + 2][20] = row[24]; // YÏó¥\n            newSheetData[index + 2][21] = row[25]; //ZÏó¥\n            newSheetData[index + 2][22] = row[26]; //AAÏó¥\n            newSheetData[index + 2][23] = row[27]; //ABÏó¥\n            newSheetData[index + 2][27] = row[29]; //ADÏó¥ / ABÏó¥ Í≥†Ïö©Î≥¥Ìóò\n            newSheetData[index + 2][28] = row[31]; //ADÏó¥ / ACÏó¥ ÏÇ∞Ïû¨Î≥¥Ìóò\n            newSheetData[index + 2][29] = row[32]; //ADÏó¥ / ACÏó¥ ÏÇ∞Ïû¨Î≥¥Ìóò\n            // YÏó¥ ÏßÄÏÇ¨ ÌîÑÎ°úÎ™®ÏÖò ÏàòÏãù Ï∂îÍ∞Ä\n            newSheetData[index + 2][24] = {\n                f: `X${index + 3}+IF(B${index + 3}>=180,(B${index + 3}-180)*1000,0)-X${index + 3}`\n            };\n            // AAÏó¥ Í≥ºÏÑ∏Ìï≠Î™© ÏàòÏãù Ï∂îÍ∞Ä\n            newSheetData[index + 2][26] = {\n                f: `X${index + 3}+Y${index + 3}+Z${index + 3}`\n            };\n            // AFÏó¥ ÏõêÏ≤úÏÑ∏ ÏàòÏãù Ï∂îÍ∞Ä\n            newSheetData[index + 2][31] = {\n                f: `((AA${index + 3}+AB${index + 3}+AC${index + 3}+AD${index + 3}+AE${index + 3})*0.967)-(AA${index + 3}+AB${index + 3}+AC${index + 3}+AD${index + 3}+AE${index + 3})`\n            };\n            // AGÏó¥ ÏàòÏãù Ï∂îÍ∞Ä\n            newSheetData[index + 2][32] = {\n                f: `AA${index + 3}+AB${index + 3}+AC${index + 3}+AD${index + 3}+AE${index + 3}+AF${index + 3}`\n            };\n        });\n        console.log(\"‚úÖ Î≥ÄÌôòÎêú Îç∞Ïù¥ÌÑ∞:\", JSON.stringify(newSheetData));\n        const newWorkbook = xlsx__WEBPACK_IMPORTED_MODULE_2__.utils.book_new();\n        const newSheet = xlsx__WEBPACK_IMPORTED_MODULE_2__.utils.aoa_to_sheet(newSheetData);\n        setCellStyles(newSheet); // Ïä§ÌÉÄÏùº Ï†ÅÏö©\n        // üî• Î≥ëÌï© Ï†ïÎ≥¥ Ï∂îÍ∞Ä\n        newSheet[\"!merges\"] = [\n            {\n                s: {\n                    r: 0,\n                    c: 0\n                },\n                e: {\n                    r: 1,\n                    c: 0\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 1\n                },\n                e: {\n                    r: 1,\n                    c: 1\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 2\n                },\n                e: {\n                    r: 1,\n                    c: 2\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 3\n                },\n                e: {\n                    r: 1,\n                    c: 3\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 4\n                },\n                e: {\n                    r: 0,\n                    c: 5\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 6\n                },\n                e: {\n                    r: 0,\n                    c: 7\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 8\n                },\n                e: {\n                    r: 0,\n                    c: 9\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 10\n                },\n                e: {\n                    r: 0,\n                    c: 11\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 12\n                },\n                e: {\n                    r: 0,\n                    c: 13\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 14\n                },\n                e: {\n                    r: 0,\n                    c: 15\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 16\n                },\n                e: {\n                    r: 0,\n                    c: 17\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 18\n                },\n                e: {\n                    r: 0,\n                    c: 19\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 20\n                },\n                e: {\n                    r: 1,\n                    c: 20\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 21\n                },\n                e: {\n                    r: 1,\n                    c: 21\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 22\n                },\n                e: {\n                    r: 1,\n                    c: 22\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 23\n                },\n                e: {\n                    r: 1,\n                    c: 23\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 24\n                },\n                e: {\n                    r: 1,\n                    c: 24\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 25\n                },\n                e: {\n                    r: 1,\n                    c: 25\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 26\n                },\n                e: {\n                    r: 1,\n                    c: 26\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 27\n                },\n                e: {\n                    r: 0,\n                    c: 30\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 31\n                },\n                e: {\n                    r: 1,\n                    c: 31\n                }\n            },\n            {\n                s: {\n                    r: 0,\n                    c: 32\n                },\n                e: {\n                    r: 1,\n                    c: 32\n                }\n            }\n        ];\n        // Ïó¥ ÎÑàÎπÑ ÏûêÎèô Ï°∞Ï†à Ï†ÅÏö©\n        autoFitColumns(newSheet, newSheetData);\n        // ÏóëÏÖÄ ÌååÏùº Ï†ÄÏû•\n        xlsx__WEBPACK_IMPORTED_MODULE_2__.utils.book_append_sheet(newWorkbook, newSheet, \"Formatted\");\n        const formattedFilePath = decryptedFilePath.replace(\".xlsx\", \"_formatted.xlsx\");\n        xlsx__WEBPACK_IMPORTED_MODULE_2__.writeFile(newWorkbook, formattedFilePath);\n        console.log(\"‚úÖ Formatted file saved:\", formattedFilePath);\n        res.setHeader(\"Content-Disposition\", \"attachment; filename=formatted.xlsx\");\n        res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n        const fileBuffer = fs__WEBPACK_IMPORTED_MODULE_1___default().readFileSync(formattedFilePath);\n        res.status(200).send(fileBuffer);\n    } catch (error) {\n        console.error(\"‚ùå Processing error:\", error);\n        res.status(500).json({\n            error: \"Failed to process the file\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVEsRUFBRSxDQUFDLEVBQUUsR0FBRzVELEdBQUcsQ0FBQyxFQUFFLEVBQUcsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsRUFBRSxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBRSxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEVBQUUsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsRUFBRSxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBRSxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFDLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUMsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FBRyxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBQyxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFDLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUMsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FBRyxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBQyxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFDLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUMsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FBRyxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBQyxLQUFLO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFDLEtBQUs7WUFDM0N3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUMsS0FBSztZQUMzQ3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FBRyxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBRSxJQUFJO1lBQzNDd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUs7WUFDNUN3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSztZQUM1Q3dELFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FBRyxHQUFHNUQsR0FBRyxDQUFDLEdBQUcsRUFBRSxnQkFBZ0I7WUFDdkR3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRzVELEdBQUcsQ0FBQyxHQUFHLEVBQUUsZ0JBQWdCO1lBQ3ZEd0QsWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc1RCxHQUFHLENBQUMsR0FBRyxFQUFFLGdCQUFnQjtZQUV2RCxtQkFBbUI7WUFDbkJ3RCxZQUFZLENBQUNJLFFBQVEsRUFBRSxDQUFDLEdBQUcsR0FBRztnQkFDNUJDLEdBQUcsQ0FBQyxDQUFDLEVBQUVELFFBQVEsRUFBRSxLQUFLLEVBQUVBLFFBQVEsRUFBRSxRQUFRLEVBQUVBLFFBQVEsRUFBRSxlQUFlLEVBQUVBLFFBQVEsR0FBRztZQUNwRjtZQUVBLGlCQUFpQjtZQUNqQkosWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc7Z0JBQzVCQyxHQUFHLENBQUMsQ0FBQyxFQUFFRCxRQUFRLEVBQUUsRUFBRSxFQUFFQSxRQUFRLEVBQUUsRUFBRSxFQUFFQSxRQUFRLEdBQUc7WUFDaEQ7WUFFQSxnQkFBZ0I7WUFDaEJKLFlBQVksQ0FBQ0ksUUFBUSxFQUFFLENBQUMsR0FBRyxHQUFHO2dCQUM1QkMsR0FBRyxDQUFDLElBQUksRUFBRUQsUUFBUSxFQUFFLEdBQUcsRUFBRUEsUUFBUSxFQUFFLEdBQUcsRUFBRUEsUUFBUSxFQUFFLEdBQUcsRUFBRUEsUUFBUSxFQUFFLEdBQUcsRUFBRUEsUUFBUSxFQUFFLFlBQVksRUFBRUEsUUFBUSxFQUFFLEdBQUcsRUFBRUEsUUFBUSxFQUFFLEdBQUcsRUFBRUEsUUFBUSxFQUFFLEdBQUcsRUFBRUEsUUFBUSxFQUFFLEdBQUcsRUFBRUEsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUN4SztZQUVBLFlBQVk7WUFDWkosWUFBWSxDQUFDSSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEdBQUc7Z0JBQzVCQyxHQUFHLENBQUMsRUFBRSxFQUFFRCxRQUFRLEVBQUUsR0FBRyxFQUFFQSxRQUFRLEVBQUUsR0FBRyxFQUFFQSxRQUFRLEVBQUUsR0FBRyxFQUFFQSxRQUFRLEVBQUUsR0FBRyxFQUFFQSxRQUFRLEVBQUUsR0FBRyxFQUFFQSxRQUFRLEdBQUc7WUFDaEc7UUFDRjtRQUVBdEIsUUFBUUMsR0FBRyxDQUFDLGNBQWNrQixLQUFLQyxTQUFTLENBQUNGO1FBRXpDLE1BQU1NLGNBQWM5RSx1Q0FBVSxDQUFDK0UsUUFBUTtRQUN2QyxNQUFNQyxXQUFXaEYsdUNBQVUsQ0FBQ2lGLFlBQVksQ0FBQ1Q7UUFDekNuRCxjQUFjMkQsV0FBVyxTQUFTO1FBQ2xDLGNBQWM7UUFDZEEsUUFBUSxDQUFDLFVBQVUsR0FBRztZQUNwQjtnQkFBRUUsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRTtnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRTtZQUFFO1lBQ3ZDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFFO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFFO1lBQUU7WUFDdkM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUU7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUU7WUFBRTtZQUN2QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRTtnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRTtZQUFFO1lBQ3ZDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFFO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFFO1lBQUU7WUFDdkM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUU7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUU7WUFBRTtZQUN2QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRTtnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRTtZQUFFO1lBQ3ZDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7WUFDekM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1lBQ3pDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7WUFDekM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1lBQ3pDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7WUFDekM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1lBQ3pDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7WUFDekM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1lBQ3pDO2dCQUFFRixHQUFHO29CQUFFQyxHQUFHO29CQUFHQyxHQUFHO2dCQUFHO2dCQUFHQyxHQUFHO29CQUFFRixHQUFHO29CQUFHQyxHQUFHO2dCQUFHO1lBQUU7WUFDekM7Z0JBQUVGLEdBQUc7b0JBQUVDLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7Z0JBQUdDLEdBQUc7b0JBQUVGLEdBQUc7b0JBQUdDLEdBQUc7Z0JBQUc7WUFBRTtZQUN6QztnQkFBRUYsR0FBRztvQkFBRUMsR0FBRztvQkFBR0MsR0FBRztnQkFBRztnQkFBR0MsR0FBRztvQkFBRUYsR0FBRztvQkFBR0MsR0FBRztnQkFBRztZQUFFO1NBQzFDO1FBQ0QsZ0JBQWdCO1FBQ2hCN0UsZUFBZXlFLFVBQVVSO1FBRXpCLFdBQVc7UUFDWHhFLHVDQUFVLENBQUNzRixpQkFBaUIsQ0FBQ1IsYUFBYUUsVUFBVTtRQUVwRCxNQUFNTyxvQkFBb0IvQixrQkFBa0JDLE9BQU8sQ0FBQyxTQUFTO1FBQzdEekQsMkNBQWMsQ0FBQzhFLGFBQWFTO1FBRTVCakMsUUFBUUMsR0FBRyxDQUFDLDJCQUEyQmdDO1FBRXZDMUMsSUFBSTRDLFNBQVMsQ0FBQyx1QkFBdUI7UUFDckM1QyxJQUFJNEMsU0FBUyxDQUFDLGdCQUFnQjtRQUU5QixNQUFNQyxhQUFhM0Ysc0RBQWUsQ0FBQ3dGO1FBQ25DMUMsSUFBSUUsTUFBTSxDQUFDLEtBQUs2QyxJQUFJLENBQUNGO0lBQ3ZCLEVBQUUsT0FBT3pDLE9BQU87UUFDZEssUUFBUUwsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckNKLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUE2QjtJQUM3RDtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvZXVuamlsZWUvRGV2ZWxvcG1lbnQvZG9kby9wYWdlcy9hcGkvZm9ybWF0LWV4Y2VsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tIFwibmV4dFwiO1xuaW1wb3J0IGZvcm1pZGFibGUgZnJvbSBcImZvcm1pZGFibGVcIjtcbmltcG9ydCBmcyBmcm9tIFwiZnNcIjtcbmltcG9ydCAqIGFzIFhMU1ggZnJvbSBcInhsc3hcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tIFwidXRpbFwiO1xuaW1wb3J0IHsgZXhlYyB9IGZyb20gXCJjaGlsZF9wcm9jZXNzXCI7XG5cbmNvbnN0IFBZVEhPTl9QQVRIID0gXCIvVXNlcnMvZXVuamlsZWUvLnZlbnZzL2RvZG9fZW52L2Jpbi9weXRob24zXCI7XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGFwaToge1xuICAgIGJvZHlQYXJzZXI6IGZhbHNlLFxuICB9LFxufTtcblxuLy8g7IWAIO2BrOq4sCDsnpDrj5kg7KGw7KCIIO2VqOyImFxuY29uc3QgYXV0b0ZpdENvbHVtbnMgPSAod29ya3NoZWV0OiBYTFNYLldvcmtTaGVldCwgZGF0YTogYW55W11bXSkgPT4ge1xuICBjb25zdCBjb2x1bW5XaWR0aHMgPSBkYXRhWzBdLm1hcCgoXywgY29sSW5kZXgpID0+IHtcbiAgICByZXR1cm4gTWF0aC5tYXgoXG4gICAgICAuLi5kYXRhLm1hcCgocm93KSA9PiAocm93W2NvbEluZGV4XSA/IHJvd1tjb2xJbmRleF0udG9TdHJpbmcoKS5sZW5ndGggOiAxMCkpXG4gICAgKTtcbiAgfSk7XG5cbiAgd29ya3NoZWV0W1wiIWNvbHNcIl0gPSBjb2x1bW5XaWR0aHMubWFwKCh3aWR0aCkgPT4gKHsgd2NoOiB3aWR0aCArIDIgfSkpO1xufTtcblxuLy8g7IWAIOyKpO2DgOydvCDshKTsoJUg7ZWo7IiYXG5jb25zdCBzZXRDZWxsU3R5bGVzID0gKHdvcmtzaGVldDogWExTWC5Xb3JrU2hlZXQpID0+IHtcbiAgY29uc3QgY29sdW1uc1RvRm9ybWF0ID0gW1xuICAgICdDJywgJ0QnLCAnRicsICdIJywgJ0onLCAnTCcsICdOJywgJ1AnLCAnUicsICdUJywgJ1UnLCAnVicsICdXJywgJ1gnLCAnWScsICdaJywgXG4gICAgLCAnQUInLCAnQUMnLCAnQUQnLCAnQUUnLCAnQUYnLCAnQUcnXG4gIF07XG5cbiAgY29uc3QgbWF4Um93ID0gd29ya3NoZWV0WychcmVmJ10gPyBwYXJzZUludCh3b3Jrc2hlZXRbJyFyZWYnXS5zcGxpdCgnOicpWzFdLm1hdGNoKC9cXGQrLyk/LlswXSB8fCBcIjJcIikgOiAyO1xuXG4gIGNvbHVtbnNUb0Zvcm1hdC5mb3JFYWNoKChjb2wpID0+IHtcbiAgICBmb3IgKGxldCByb3cgPSAyOyByb3cgPD0gbWF4Um93OyByb3crKykge1xuICAgICAgY29uc3QgY2VsbEFkZHJlc3MgPSBgJHtjb2x9JHtyb3d9YDtcbiAgICAgIGlmICh3b3Jrc2hlZXRbY2VsbEFkZHJlc3NdKSB7XG4gICAgICAgIHdvcmtzaGVldFtjZWxsQWRkcmVzc10ueiA9ICcjLCMjMCc7IC8vIOyIq+yekCDtmJXsi506IDPsnpDrpqzrp4jri6Qg7L2k66eIXG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IHBhcnNlRm9ybSA9IGFzeW5jIChyZXE6IE5leHRBcGlSZXF1ZXN0KTogUHJvbWlzZTx7IGZpbGVzOiBmb3JtaWRhYmxlLkZpbGVzIH0+ID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBmb3JtID0gZm9ybWlkYWJsZSh7IG11bHRpcGxlczogZmFsc2UsIHVwbG9hZERpcjogXCIvdG1wXCIsIGtlZXBFeHRlbnNpb25zOiB0cnVlIH0pO1xuXG4gICAgZm9ybS5wYXJzZShyZXEsIChlcnIsIGZpZWxkcywgZmlsZXMpID0+IHtcbiAgICAgIGlmIChlcnIpIHJlamVjdChlcnIpO1xuICAgICAgZWxzZSByZXNvbHZlKHsgZmlsZXMgfSk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gXCJQT1NUXCIpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogXCJNZXRob2QgTm90IEFsbG93ZWRcIiB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyBmaWxlcyB9ID0gYXdhaXQgcGFyc2VGb3JtKHJlcSk7XG4gICAgaWYgKCFmaWxlcy5maWxlKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogXCJGaWxlIG5vdCBmb3VuZCBvciBpbnZhbGlkIGZpbGVcIiB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBmaWxlID0gQXJyYXkuaXNBcnJheShmaWxlcy5maWxlKSA/IGZpbGVzLmZpbGVbMF0gOiAoZmlsZXMuZmlsZSBhcyBmb3JtaWRhYmxlLkZpbGUpO1xuICAgIGlmICghZmlsZS5maWxlcGF0aCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6IFwiSW52YWxpZCBmaWxlIHBhdGhcIiB9KTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIvCfk4wgUHJvY2Vzc2luZyBlbmNyeXB0ZWQgZmlsZTpcIiwgZmlsZS5maWxlcGF0aCk7XG5cbiAgICBjb25zdCBkZWNyeXB0ZWRGaWxlUGF0aCA9IGZpbGUuZmlsZXBhdGgucmVwbGFjZShcIi54bHN4XCIsIFwiX2RlY3J5cHRlZC54bHN4XCIpO1xuXG4gICAgY29uc3QgY29tbWFuZCA9IGAke1BZVEhPTl9QQVRIfSBkZWNyeXB0X2V4Y2VsLnB5IFwiJHtmaWxlLmZpbGVwYXRofVwiIFwiJHtkZWNyeXB0ZWRGaWxlUGF0aH1cImA7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgc3Rkb3V0LCBzdGRlcnIgfSA9IGF3YWl0IHByb21pc2lmeShleGVjKShjb21tYW5kKTtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+TjCBQeXRob24gT3V0cHV0OlwiLCBzdGRvdXQpO1xuICAgICAgY29uc29sZS5lcnJvcihcIvCfk4wgUHl0aG9uIEVycm9yOlwiLCBzdGRlcnIpO1xuXG4gICAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZGVjcnlwdGVkRmlsZVBhdGgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihg4p2MIERlY3J5cHRlZCBmaWxlIG5vdCBmb3VuZDogJHtkZWNyeXB0ZWRGaWxlUGF0aH1gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coXCLinIUgRGVjcnlwdGVkIGZpbGUgY3JlYXRlZDpcIiwgZGVjcnlwdGVkRmlsZVBhdGgpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEZhaWxlZCB0byBkZWNyeXB0IGZpbGU6XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBcIkZhaWxlZCB0byBkZWNyeXB0IGZpbGUuIENoZWNrIHBhc3N3b3JkIG9yIGVuY3J5cHRpb24gdHlwZS5cIiB9KTtcbiAgICB9XG5cbiAgICAvLyDslZTtmLgg7ZW07KCc65CcIO2MjOydvOydhCDsnb3quLBcbiAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZEZpbGUoZGVjcnlwdGVkRmlsZVBhdGgpO1xuICAgIGNvbnN0IHNoZWV0ID0gd29ya2Jvb2suU2hlZXRzW3dvcmtib29rLlNoZWV0TmFtZXNbMF1dO1xuICAgIGNvbnN0IGpzb25EYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHNoZWV0LCB7IGhlYWRlcjogMSB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIEV4Y2VsIGRhdGEgbG9hZGVkOlwiLCBqc29uRGF0YS5sZW5ndGgpO1xuXG4gICAgLy8g7IOI66Gc7Jq0IOyLnO2KuCDrjbDsnbTthLAg7IOd7ISxXG4gICAgY29uc3QgbmV3U2hlZXREYXRhOiBhbnlbXVtdID0gW107XG5cbiAgICAvLyDqs6DsoJXrkJwg7Luk7Iqk7YWAIO2XpOuNlCDshKTsoJVcbiAgICBuZXdTaGVldERhdGFbMF0gPSBbXG4gICAgICBcIuyEse2VqFwiLCBcIuy0nSDsmKTrjZTsiJhcIiwgXCLquLDrs7gg6riI7JWhXCIsIFwi7KeA7Jet64uo6rCAXCIsIFwi67Cw64us6rGw66asIO2VoOymnVwiLCBcIlwiLCBcIu2UveyXheyngCDtlaDspp1cIiwgXCJcIiwgXCLrj4TssKnsp4Ag7ZWg7KadXCIsIFwiXCIsIFxuICAgICAgXCLquLDsg4Eg7ZWg7KadXCIsIFwiXCIsIFwi6riw7YOAIO2UhOuhnOuqqOyFmCAxXCIsIFwiXCIsIFwi6riw7YOAIO2UhOuhnOuqqOyFmCAyXCIsIFwiXCIsIFwi6riw7YOAIO2UhOuhnOuqqOyFmCAzXCIsIFwiXCIsIFwi6riw7YOAIO2UhOuhnOuqqOyFmCA0XCIsIFwiXCIsIFxuICAgICAgXCLsoJXsgrDquIjslaFcIiwgXCLstJ0g7KeA7JuQ6riIXCIsIFwi7LCo6rCQ64K07JetXCIsIFwi7ZWp6rOE6riI7JWhXCIsIFwi7KeA7IKsIO2UhOuhnOuqqOyFmFwiLCBcIuyVvOqwhCDtlITroZzrqqjshZhcIiwgXCLqs7zshLgg7ZWt66qpXCIsIFwi67mE6rO87IS4IO2VreuqqVwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIuybkOyynOyEuFwiLCBcIuygleyCsOyYiOyglSDquIjslaFcIlxuICAgIF07XG4gICAgXG4gICAgbmV3U2hlZXREYXRhWzFdID0gW1xuICAgICAgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCLsmKTrjZQg7IiYXCIsIFwi6riI7JWhXCIsIFwi7Jik642UIOyImFwiLCBcIuq4iOyVoVwiLCBcIuyYpOuNlCDsiJhcIiwgXCLquIjslaFcIiwgXG4gICAgICBcIuyYpOuNlCDsiJhcIiwgXCLquIjslaFcIiwgXCLsmKTrjZQg7IiYXCIsIFwi6riI7JWhXCIsIFwi7Jik642UIOyImFwiLCBcIuq4iOyVoVwiLCBcIuyYpOuNlCDsiJhcIiwgXCLquIjslaFcIiwgXCLsmKTrjZQg7IiYXCIsIFwi6riI7JWhXCIsIFxuICAgICAgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCLstJ0g7KCE7IKw6riI7JWhXCIsIFwi6rOg7Jqp67O07ZeYXCIsIFwi7IKw7J6s67O07ZeYXCIsIFwi7Iuc6rCE7KCc67O07ZeYXCIsIFwi67O07ZeY66OM7IaM6riJXCIsIFwiXCIsIFwiXCJcbiAgICBdO1xuXG4gICAgY29uc29sZS5sb2coXCLinIUg7Zek642UIOy2lOqwgOuQqDpcIiwgSlNPTi5zdHJpbmdpZnkobmV3U2hlZXREYXRhWzBdKSwgSlNPTi5zdHJpbmdpZnkobmV3U2hlZXREYXRhWzFdKSk7XG5cbiAgICAvLyDrs7jrrLgg642w7J207YSwIOy2lOqwgCAoMTTtlonrtoDthLApXG4gICAganNvbkRhdGEuc2xpY2UoMTMpLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHtcbiAgICAgIGlmICghbmV3U2hlZXREYXRhW2luZGV4ICsgMl0pIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdID0gW107IC8vIDLspITsnbQg7J2066+4IOyeiOycvOuvgOuhnCBpbmRleCArIDJcblxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMF0gPSByb3dbMl07ICAvLyBD7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsxXSA9IHJvd1s1XTsgIC8vIEbsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzJdID0gcm93WzZdOyAgLy8gR+yXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bM10gPSByb3dbN107ICAvLyBI7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVs0XSA9IHJvd1s4XTsgIC8vIEnsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzVdID0gcm93WzldOyAgLy8gSuyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bNl0gPSByb3dbMTBdOyAvLyBL7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVs3XSA9IHJvd1sxMV07IC8vIEzsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzhdID0gcm93WzEyXTsgLy8gTeyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bOV0gPSByb3dbMTNdOyAvLyBO7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsxMF0gPSByb3dbMTRdOy8vIE/sl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzExXSA9IHJvd1sxNV07Ly8gUOyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMTJdID0gcm93WzE2XTsvLyBR7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsxM10gPSByb3dbMTddOy8vIFLsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzE0XSA9IHJvd1sxOF07Ly8gU+yXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMTVdID0gcm93WzE5XTsvLyBU7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsxNl0gPSByb3dbMjBdOy8vIFXsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzE3XSA9IHJvd1syMV07Ly8gVuyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMThdID0gcm93WzIyXTsvLyBX7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsxOV0gPSByb3dbMjNdOy8vIFjsl7RcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzIwXSA9IHJvd1syNF07Ly8gWeyXtFxuICAgICAgbmV3U2hlZXREYXRhW2luZGV4ICsgMl1bMjFdID0gcm93WzI1XTsgLy9a7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsyMl0gPSByb3dbMjZdOyAvL0FB7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsyM10gPSByb3dbMjddOyAvL0FC7Je0XG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsyN10gPSByb3dbMjldOyAvL0FE7Je0IC8gQULsl7Qg6rOg7Jqp67O07ZeYXG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsyOF0gPSByb3dbMzFdOyAvL0FE7Je0IC8gQUPsl7Qg7IKw7J6s67O07ZeYXG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsyOV0gPSByb3dbMzJdOyAvL0FE7Je0IC8gQUPsl7Qg7IKw7J6s67O07ZeYXG5cbiAgICAgIC8vIFnsl7Qg7KeA7IKsIO2UhOuhnOuqqOyFmCDsiJjsi50g7LaU6rCAXG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsyNF0gPSB7XG4gICAgICAgIGY6IGBYJHtpbmRleCArIDN9K0lGKEIke2luZGV4ICsgM30+PTE4MCwoQiR7aW5kZXggKyAzfS0xODApKjEwMDAsMCktWCR7aW5kZXggKyAzfWBcbiAgICAgIH07XG5cbiAgICAgIC8vIEFB7Je0IOqzvOyEuO2VreuqqSDsiJjsi50g7LaU6rCAXG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVsyNl0gPSB7XG4gICAgICAgIGY6IGBYJHtpbmRleCArIDN9K1kke2luZGV4ICsgM30rWiR7aW5kZXggKyAzfWBcbiAgICAgIH07XG5cbiAgICAgIC8vIEFG7Je0IOybkOyynOyEuCDsiJjsi50g7LaU6rCAXG4gICAgICBuZXdTaGVldERhdGFbaW5kZXggKyAyXVszMV0gPSB7XG4gICAgICAgIGY6IGAoKEFBJHtpbmRleCArIDN9K0FCJHtpbmRleCArIDN9K0FDJHtpbmRleCArIDN9K0FEJHtpbmRleCArIDN9K0FFJHtpbmRleCArIDN9KSowLjk2NyktKEFBJHtpbmRleCArIDN9K0FCJHtpbmRleCArIDN9K0FDJHtpbmRleCArIDN9K0FEJHtpbmRleCArIDN9K0FFJHtpbmRleCArIDN9KWBcbiAgICAgIH07XG5cbiAgICAgIC8vIEFH7Je0IOyImOyLnSDstpTqsIBcbiAgICAgIG5ld1NoZWV0RGF0YVtpbmRleCArIDJdWzMyXSA9IHtcbiAgICAgICAgZjogYEFBJHtpbmRleCArIDN9K0FCJHtpbmRleCArIDN9K0FDJHtpbmRleCArIDN9K0FEJHtpbmRleCArIDN9K0FFJHtpbmRleCArIDN9K0FGJHtpbmRleCArIDN9YFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIOuzgO2ZmOuQnCDrjbDsnbTthLA6XCIsIEpTT04uc3RyaW5naWZ5KG5ld1NoZWV0RGF0YSkpO1xuXG4gICAgY29uc3QgbmV3V29ya2Jvb2sgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7XG4gICAgY29uc3QgbmV3U2hlZXQgPSBYTFNYLnV0aWxzLmFvYV90b19zaGVldChuZXdTaGVldERhdGEpO1xuICAgIHNldENlbGxTdHlsZXMobmV3U2hlZXQpOyAvLyDsiqTtg4Dsnbwg7KCB7JqpXG4gICAgLy8g8J+UpSDrs5Htlakg7KCV67O0IOy2lOqwgFxuICAgIG5ld1NoZWV0W1wiIW1lcmdlc1wiXSA9IFtcbiAgICAgIHsgczogeyByOiAwLCBjOiAwIH0sIGU6IHsgcjogMSwgYzogMCB9IH0sIC8vIOyEse2VqCAo7IS466GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAxIH0sIGU6IHsgcjogMSwgYzogMSB9IH0sIC8vIOy0nSDsmKTrjZTsiJggKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMiB9LCBlOiB7IHI6IDEsIGM6IDIgfSB9LCAvLyDquLDrs7gg6riI7JWhICjshLjroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDMgfSwgZTogeyByOiAxLCBjOiAzIH0gfSwgLy8g7KeA7Jet64uo6rCAICjshLjroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDQgfSwgZTogeyByOiAwLCBjOiA1IH0gfSwgLy8g67Cw64us6rGw66asIO2VoOymnSAo6rCA66GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiA2IH0sIGU6IHsgcjogMCwgYzogNyB9IH0sIC8vIO2UveyXheyngCDtlaDspp0gKOqwgOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogOCB9LCBlOiB7IHI6IDAsIGM6IDkgfSB9LCAvLyDrj4TssKnsp4Ag7ZWg7KadICjqsIDroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDEwIH0sIGU6IHsgcjogMCwgYzogMTEgfSB9LCAvLyDquLDsg4Eg7ZWg7KadICjqsIDroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDEyIH0sIGU6IHsgcjogMCwgYzogMTMgfSB9LCAvLyDquLDtg4Ag7ZSE66Gc66qo7IWYIDEgKOqwgOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMTQgfSwgZTogeyByOiAwLCBjOiAxNSB9IH0sIC8vIOq4sO2DgCDtlITroZzrqqjshZggMiAo6rCA66GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAxNiB9LCBlOiB7IHI6IDAsIGM6IDE3IH0gfSwgLy8g6riw7YOAIO2UhOuhnOuqqOyFmCAzICjqsIDroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDE4IH0sIGU6IHsgcjogMCwgYzogMTkgfSB9LCAvLyDquLDtg4Ag7ZSE66Gc66qo7IWYIDQgKOqwgOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMjAgfSwgZTogeyByOiAxLCBjOiAyMCB9IH0sIC8vIOygleyCsOq4iOyVoSAo7IS466GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAyMSB9LCBlOiB7IHI6IDEsIGM6IDIxIH0gfSwgLy8g7LSdIOyngOybkOq4iCAo7IS466GcIOuzke2VqSlcbiAgICAgIHsgczogeyByOiAwLCBjOiAyMiB9LCBlOiB7IHI6IDEsIGM6IDIyIH0gfSwgLy8g7LCo6rCQ64K07JetICjshLjroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDIzIH0sIGU6IHsgcjogMSwgYzogMjMgfSB9LCAvLyDtlanqs4TquIjslaEgKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMjQgfSwgZTogeyByOiAxLCBjOiAyNCB9IH0sIC8vIOyngOyCrCDtlITroZzrqqjshZggKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMjUgfSwgZTogeyByOiAxLCBjOiAyNSB9IH0sIC8vIOyVvOqwhCDtlITroZzrqqjshZggKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMjYgfSwgZTogeyByOiAxLCBjOiAyNiB9IH0sIC8vIOqzvOyEuCDtla3rqqkgLyDstJ0g7KCE7IKw6riI7JWhICjshLjroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDI3IH0sIGU6IHsgcjogMCwgYzogMzAgfSB9LCAvLyDruYTqs7zshLgg7ZWt66qpICjqsIDroZwg67OR7ZWpKVxuICAgICAgeyBzOiB7IHI6IDAsIGM6IDMxIH0sIGU6IHsgcjogMSwgYzogMzEgfSB9LCAvLyDsm5DsspzshLggKOyEuOuhnCDrs5HtlakpXG4gICAgICB7IHM6IHsgcjogMCwgYzogMzIgfSwgZTogeyByOiAxLCBjOiAzMiB9IH0sIC8vIOygleyCsOyYiOyglSDquIjslaEgKOyEuOuhnCDrs5HtlakpXG4gICAgXTtcbiAgICAvLyDsl7Qg64SI67mEIOyekOuPmSDsobDsoIgg7KCB7JqpXG4gICAgYXV0b0ZpdENvbHVtbnMobmV3U2hlZXQsIG5ld1NoZWV0RGF0YSk7XG5cbiAgICAvLyDsl5HshYAg7YyM7J28IOyggOyepVxuICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQobmV3V29ya2Jvb2ssIG5ld1NoZWV0LCBcIkZvcm1hdHRlZFwiKTtcblxuICAgIGNvbnN0IGZvcm1hdHRlZEZpbGVQYXRoID0gZGVjcnlwdGVkRmlsZVBhdGgucmVwbGFjZShcIi54bHN4XCIsIFwiX2Zvcm1hdHRlZC54bHN4XCIpO1xuICAgIFhMU1gud3JpdGVGaWxlKG5ld1dvcmtib29rLCBmb3JtYXR0ZWRGaWxlUGF0aCk7XG5cbiAgICBjb25zb2xlLmxvZyhcIuKchSBGb3JtYXR0ZWQgZmlsZSBzYXZlZDpcIiwgZm9ybWF0dGVkRmlsZVBhdGgpO1xuXG4gICAgcmVzLnNldEhlYWRlcihcIkNvbnRlbnQtRGlzcG9zaXRpb25cIiwgXCJhdHRhY2htZW50OyBmaWxlbmFtZT1mb3JtYXR0ZWQueGxzeFwiKTtcbiAgICByZXMuc2V0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXRcIik7XG5cbiAgICBjb25zdCBmaWxlQnVmZmVyID0gZnMucmVhZEZpbGVTeW5jKGZvcm1hdHRlZEZpbGVQYXRoKTtcbiAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChmaWxlQnVmZmVyKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIFByb2Nlc3NpbmcgZXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBcIkZhaWxlZCB0byBwcm9jZXNzIHRoZSBmaWxlXCIgfSk7XG4gIH1cbn07Il0sIm5hbWVzIjpbImZvcm1pZGFibGUiLCJmcyIsIlhMU1giLCJwcm9taXNpZnkiLCJleGVjIiwiUFlUSE9OX1BBVEgiLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwiYXV0b0ZpdENvbHVtbnMiLCJ3b3Jrc2hlZXQiLCJkYXRhIiwiY29sdW1uV2lkdGhzIiwibWFwIiwiXyIsImNvbEluZGV4IiwiTWF0aCIsIm1heCIsInJvdyIsInRvU3RyaW5nIiwibGVuZ3RoIiwid2lkdGgiLCJ3Y2giLCJzZXRDZWxsU3R5bGVzIiwiY29sdW1uc1RvRm9ybWF0IiwibWF4Um93IiwicGFyc2VJbnQiLCJzcGxpdCIsIm1hdGNoIiwiZm9yRWFjaCIsImNvbCIsImNlbGxBZGRyZXNzIiwieiIsInBhcnNlRm9ybSIsInJlcSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZm9ybSIsIm11bHRpcGxlcyIsInVwbG9hZERpciIsImtlZXBFeHRlbnNpb25zIiwicGFyc2UiLCJlcnIiLCJmaWVsZHMiLCJmaWxlcyIsImhhbmRsZXIiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJmaWxlIiwiQXJyYXkiLCJpc0FycmF5IiwiZmlsZXBhdGgiLCJjb25zb2xlIiwibG9nIiwiZGVjcnlwdGVkRmlsZVBhdGgiLCJyZXBsYWNlIiwiY29tbWFuZCIsInN0ZG91dCIsInN0ZGVyciIsImV4aXN0c1N5bmMiLCJFcnJvciIsIndvcmtib29rIiwicmVhZEZpbGUiLCJzaGVldCIsIlNoZWV0cyIsIlNoZWV0TmFtZXMiLCJqc29uRGF0YSIsInV0aWxzIiwic2hlZXRfdG9fanNvbiIsImhlYWRlciIsIm5ld1NoZWV0RGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzbGljZSIsImluZGV4IiwiZiIsIm5ld1dvcmtib29rIiwiYm9va19uZXciLCJuZXdTaGVldCIsImFvYV90b19zaGVldCIsInMiLCJyIiwiYyIsImUiLCJib29rX2FwcGVuZF9zaGVldCIsImZvcm1hdHRlZEZpbGVQYXRoIiwid3JpdGVGaWxlIiwic2V0SGVhZGVyIiwiZmlsZUJ1ZmZlciIsInJlYWRGaWxlU3luYyIsInNlbmQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/format-excel.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fformat-excel&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fformat-excel.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();